<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Second Task</title>
  <link rel="stylesheet" href="max.css">
</head>
<body>
  <main class="latvian">
    <audio controls preload="auto" class="audio" loop autoplay>
      <source src="birdy.mp3" type="audio/mpeg">
    </audio>
    <div class="page-center animate1">
      <h1>Congratulations on completing your first assignment</h1>
    </div>
    <div class="page-center animate2 animate-delay-6">
      <p>You earned the first part of the code card</p>
      <br>
      <img src="code1.svg" alt="QR1" class="qr">
    </div>
    <div class="animate3 animate-delay-13">
      <div class="page-center">
        <h2>The Second Task.</h2>
        <h2>Ask your close friend.</h2>
        <br>
        <form action="https://help-animals-russia.ru/mrmax/the-second-task.php" id="form">
          <input required type="text" placeholder="The Answer" class="answer" name="answer" id="answer">
          <br>
          <div class="elf-btn-wrapper"><input type="submit" class="elf-btn send-btn" value="Send"></div>
        </form>
        <br>
        <br>
        <div class="status">2/5</div>
      </div>
    </div>
    <div class="notification hidden"></div>
  </main>
  <script>
    let form = document.getElementById('form');
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      let request = new XMLHttpRequest();
      const answer = new FormData(form).get('answer');
      request.open("GET", `https://help-animals-russia.ru/mrmax/the-second-task.php?answer=${answer}`);
      request.send();
      request.addEventListener("load", function(response) {
        const re = JSON.parse(response.target.response);
        if (re.url) {
          window.location.href = re.url;
        } else {
          document.querySelector('.notification').innerHTML = re.text;
          document.querySelector('.notification').classList.remove('hidden');
          setTimeout(function() {
            document.querySelector('.notification').classList.add('fade-out');
            setTimeout(function() {
              document.querySelector('.notification').classList.add('hidden');
              document.querySelector('.notification').classList.remove('fade-out');
            }, 3000);
          }, 2000);
        }
      });
    });
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-63371694-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
